

<!DOCTYPE html>

<meta charset="utf-8">
<head>
<title>Chameleon</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/fomantic-ui@2.8.4/dist/semantic.min.css">
<script src="https://cdn.jsdelivr.net/npm/fomantic-ui@2.8.4/dist/semantic.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.7.0/dropzone.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.7.0/dropzone.css">


<style>
    .card {
      margin-top: 10px;
    }

    body {
      background-color: #373E58;
    }

    .main-box {
      margin-top: 5rem;
    }

    body>.container {
      padding: 24px;
      background-color: #373E58;
    }

    .hits-box {
      padding: 1px 14px 12px;
    }


  </style>
</head>


<body>
    <div class="ui top fixed stackable menu">
      <div class="item">
        <h2>Chameleon - The Color API</h2>
      </div>
    </div>
  
    <div class="ui container main-box">
      <div class="ui grid">
          <div class="row mobile only">
              <br>
              <br>
          </div>
      </div>
      <div class="submit-box" id="form-div">
        <div class="ui brown top attached segment">
          <h3>  Share your story:</h3>
        </div>
        <form class="ui equal width attached segment form" id="submission">
            <div class="clsbox-1" runat="server"  >
                <div class="dropzone clsbox" id="mydropzone">
            
                </div>
            </div>
        </form>
      </div>
  
      <div class="ui horizontal divider" id="hr-divider">
        Or
      </div>
  
      <div class="rates-box">
        <div class="ui purple top attached segment">
          <div class="ui stackable grid">
            <img id="schemeImg" class="ui centered large image" src="">
          </div>
        </div>
        
        <div class="ui attached segment">
          <br>
          <div class="ui three column grid">
            <div class="ui cards" id="voices">
  
            </div>
  
          <br>
        </div>
  
      </div>
    </div>
    <br>
  
  </body>


<script>
Dropzone.autoDiscover = false;
var myDropzone = new Dropzone("div#mydropzone", { url: "https://chameleon-photos.s3.amazonaws.com/"});

var urlData = {}
fetch('https://6i9a83mpfl.execute-api.us-east-1.amazonaws.com/dev/generate')
  .then(response => response.json())
  .then(data => 
  {
    urlData = data
    console.log(urlData)
  });
console.log(urlData)

myDropzone.on('sending', async function(file, xhr, formData){
    console.log(formData)
    console.log('URL DATA:' + urlData)
    var i;
    for (const f in urlData){
        console.log(f)
        console.log(urlData[f])
        formData.append(f, urlData[f]);
    }
    console.log(formData)
});

myDropzone.on("complete", function(file) {
  myDropzone.removeFile(file);
  document.getElementById("schemeImg").src = "https://chameleon-photos.s3.amazonaws.com/" + urlData['key'];
});

</script>
